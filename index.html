<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shelf Configurator for IKEA Komplement Filament System by Kefir</title>
<style>
  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background-color: #121212;
    color: #f0f0f0;
  }

  .container {
    max-width: 900px;
    margin: 20px auto;
    padding: 0 15px;
    box-sizing: border-box;
  }

  h1 {
    text-align: center;
    font-size: 1.8em;
    color: #ffffff;
  }

  .calculator {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    background: #1e1e1e;
    padding: 20px;
    border-radius: 10px;
  }

  .input-section, .output-section {
    flex: 1 1 300px;
  }

  .output-section {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .input-section label {
    display: block;
    margin: 10px 0 5px;
    color: #ddd;
  }

  .segment-input {
    width: 100%;
    padding: 5px;
    font-size: 1em;
    background-color: #2a2a2a;
    color: #f0f0f0;
    border: 1px solid #444;
    border-radius: 4px;
  }

  .button-wrapper {
    margin-top: 15px;
  }

  .calculate-button {
    padding: 12px 24px;
    font-size: 1.1em;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
  }

  .results-container {
    display: flex;
    flex-direction: column;
    gap: 20px;
    margin-top: 30px;
  }

  .section-box {
    background: #1e1e1e;
    padding: 15px;
    border-radius: 10px;
  }

  .section-title {
    font-weight: bold;
    margin-bottom: 10px;
    color: #ffffff;
  }

  .visualization {
    display: flex;
    flex-direction: column;
    gap: 10px;
    align-items: center;
  }

  .shelf-row {
    display: flex;
    width: 100%;
    box-sizing: border-box;
    position: relative;
  }

  .bracket {
    width: 10px;
    height: 20px;
    display: inline-block;
  }

  .bracket.left, .bracket.right {
    background-color: green;
  }

  .bracket.connector {
    background-color: red;
  }

  .bracket.support {
    background-color: yellow;
    width: 10px;
    height: 20px;
    display: inline-block;
  }

  .rod {
    height: 10px;
    background-color: #888;
    display: inline-block;
    position: relative;
    border-radius: 0;
    margin-top: 5px;
  }

  .output-columns {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
  }

  .output-column {
    flex: 1 1 300px;
    background: #1e1e1e;
    padding: 15px;
    border-radius: 10px;
  }

  .bracket-info span {
    display: block;
    margin-bottom: 5px;
  }

  .green { color: green; }
  .red { color: red; }
  .yellow { color: goldenrod; }

  .length-capacity-container {
    display: flex;
    gap: 40px;
    align-items: baseline;
  }

  .length-capacity-container > div {
    font-size: 1.2em;
  }

  .input-section label,
  .input-section select,
  .input-section input {
    display: block;
    margin-bottom: 15px;
  }

  select, input[type="text"], input[type="number"] {
    background-color: #2a2a2a;
    color: #f0f0f0;
    border: 1px solid #444;
    border-radius: 4px;
    padding: 6px;
  }
</style>

</head>
<body>
  <div class="container">
    <h1>Shelf Configurator for IKEA Komplement Filament System by Kefir</h1>
    <br>
    <h1><a href="https://www.printables.com/model/1373893" target="_blank">https://www.printables.com/model/1373893</a></h1>
    <div class="calculator">
      <div class="input-section">
        
        <h2>Select your segments:</h2>
        <label for="seg50">Segments built from IKEA Komplement 50 cm:</label>
        <input id="seg50" type="number" min="0" value="0" class="segment-input" />
        <label for="seg75">Segments built from IKEA Komplement 75 cm:</label>
        <input id="seg75" type="number" min="0" value="0" class="segment-input" />
        <label for="seg100">Segments built from IKEA Komplement 100 cm:</label>
        <input id="seg100" type="number" min="0" value="0" class="segment-input" />
		<label for="rodColor">Rails Color:</label>
        <select id="rodColor" class="segment-input">
          <option value="white">White</option>
          <option value="gray">Gray</option>
        </select>
        <label for="spoolWidth">Spool width (mm):</label>
        <input id="spoolWidth" type="number" min="1" value="68" class="segment-input" />
      </div>
      <div class="output-section">
        <div class="button-wrapper">
          <button class="calculate-button" onclick="calculate()">Calculate</button>
        </div>
      </div>
    </div>

    <div class="results-container">
      <div class="section-box length-capacity-container">
        <div>
          <div class="section-title">Total Length</div>
          <div id="shelfLength"></div>
        </div>
        <div>
          <div class="section-title">
  Estimated Spool Capacity (<span id="spoolWidthLabel">68</span> mm)
</div>
<div id="spoolCapacity"></div>
        </div>
      </div>
      <div class="section-box">
        <div class="section-title">Visualization</div>
        <div id="visualization" class="visualization"></div>
      </div>
      <div class="output-columns">
        <div class="output-column">
          <div class="section-title">Brackets to 3Dprint</div>
          <div id="bracketCounts" class="bracket-info"></div>
        </div>
        <div class="output-column">
          <div class="section-title">IKEA shopping list</div>
          <div id="ikeaList"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const ROD_LENGTHS = {
      '50': 450,
      '75': 700,
      '100': 950
    };

    const IKEA_CODES = {
      white: {
        '50': '902.568.93',
        '75': '402.568.95',
        '100': '302.568.91'
      },
      gray: {
        '50': '402.569.42',
        '75': '002.569.44',
        '100': '802.569.40'
      }
    };

    function calculate() {
  const rodColor = document.getElementById('rodColor').value;
  const seg50 = parseInt(document.getElementById('seg50').value) || 0;
  const seg75 = parseInt(document.getElementById('seg75').value) || 0;
  const seg100 = parseInt(document.getElementById('seg100').value) || 0;
  const spoolWidth = parseFloat(document.getElementById('spoolWidth').value) || 68;

  // ✅ Zabezpieczenie: brak segmentów = brak obliczeń
  if (seg50 === 0 && seg75 === 0 && seg100 === 0) {
    alert("Please select at least one segment.");
    return;
  }

  const segments = [];
  for (let i = 0; i < seg50; i++) segments.push(50);
  for (let i = 0; i < seg75; i++) segments.push(75);
  for (let i = 0; i < seg100; i++) segments.push(100);

  // dalsza część funkcji bez zmian...
  const totalLength = segments.reduce((acc, val) => acc + ROD_LENGTHS[val], 0)
    + 20 + 20 + (segments.length - 1) * 10;

  let totalSpoolCapacity = 0;
  segments.forEach(seg => {
    const rodLen = ROD_LENGTHS[seg];
    const effectiveLen = rodLen - 20;
    if (seg === 75 || seg === 100) {
      const halfLen = (effectiveLen / 2) - 15;
      const spoolsLeft = Math.floor(halfLen / spoolWidth);
      const spoolsRight = Math.floor(halfLen / spoolWidth);
      totalSpoolCapacity += spoolsLeft + spoolsRight;
    } else {
      totalSpoolCapacity += Math.floor(effectiveLen / spoolWidth);
    }
  });

  const bracketCounts = {
    left: segments.length > 0 ? 1 : 0,
    right: segments.length > 0 ? 1 : 0,
    connector: Math.max(0, segments.length - 1),
    support: segments.filter(len => len === 75 || len === 100).length
  };

  const ikeaItems = {
    '50': seg50 * 2,
    '75': seg75 * 2,
    '100': seg100 * 2
  };

  document.getElementById('shelfLength').innerText = `${totalLength} mm`;
  document.getElementById('spoolCapacity').innerText = `${totalSpoolCapacity} spools`;

  let bracketHTML = '';
  if (bracketCounts.left > 0) bracketHTML += `<span class="green">Holder LEFT x ${bracketCounts.left}</span>`;
  if (bracketCounts.right > 0) bracketHTML += `<span class="green">Holder RIGHT x ${bracketCounts.right}</span>`;
  if (bracketCounts.connector > 0) bracketHTML += `<span class="red">Holder CONNECTOR x ${bracketCounts.connector}</span>`;
  if (bracketCounts.support > 0) bracketHTML += `<span class="yellow">Holder MIDDLE x ${bracketCounts.support}</span>`;
  document.getElementById('bracketCounts').innerHTML = bracketHTML;

  let ikeaHTML = '';
  Object.keys(ikeaItems).forEach(k => {
    if (ikeaItems[k] > 0) {
      const code = IKEA_CODES[rodColor][k];
      const searchUrl = `https://www.google.com/search?q=${code}`;
      ikeaHTML += `<div>${ikeaItems[k]}x Komplement ${k} cm - <a href="${searchUrl}" target="_blank">${code}</a></div>`;
    }
  });
  document.getElementById('ikeaList').innerHTML = ikeaHTML;

  renderVisualization(segments, rodColor);
}
  function renderVisualization(segments, color) {
  const container = document.getElementById('visualization');
  container.innerHTML = '';
  const row = document.createElement('div');
  row.className = 'shelf-row';

  const left = document.createElement('div');
  left.className = 'bracket left';
  row.appendChild(left);

  segments.forEach((seg, index) => {
    const rodColor = color === 'gray' ? '#666' : '#ccc';

    if (seg === 75 || seg === 100) {
      const totalWidth = ROD_LENGTHS[seg] / 5;
      const halfWidth = (totalWidth - 10) / 2;

      // Left half
      const leftRod = document.createElement('div');
      leftRod.className = 'rod';
      leftRod.style.backgroundColor = rodColor;
      leftRod.style.width = halfWidth + 'px';
      row.appendChild(leftRod);

      // Yellow support bracket
      const support = document.createElement('div');
      support.className = 'bracket support';
      support.style.left = '0px';
      row.appendChild(support);

      // Right half
      const rightRod = document.createElement('div');
      rightRod.className = 'rod';
      rightRod.style.backgroundColor = rodColor;
      rightRod.style.width = halfWidth + 'px';
      row.appendChild(rightRod);
    } else {
      // Single full rod
      const rod = document.createElement('div');
      rod.className = 'rod';
      rod.style.backgroundColor = rodColor;
      rod.style.width = ROD_LENGTHS[seg] / 5 + 'px';
      row.appendChild(rod);
    }

    if (index < segments.length - 1) {
      const connector = document.createElement('div');
      connector.className = 'bracket connector';
      row.appendChild(connector);
    }
  });

  const right = document.createElement('div');
  right.className = 'bracket right';
  row.appendChild(right);

  container.appendChild(row);
}
	  
	  
	  
	  
	  
	  
	/* function renderVisualization(segments, color) {
      const container = document.getElementById('visualization');
      container.innerHTML = '';
      const row = document.createElement('div');
      row.className = 'shelf-row';

      const left = document.createElement('div');
      left.className = 'bracket left';
      row.appendChild(left);

      segments.forEach((seg, index) => {
        const rod = document.createElement('div');
        rod.className = 'rod';
        rod.style.backgroundColor = color === 'gray' ? '#666' : '#ccc';
        const width = ROD_LENGTHS[seg] / 5;
        rod.style.width = width + 'px';

        if (seg === 75 || seg === 100) {
          const support = document.createElement('div');
          support.className = 'bracket support';
          support.style.left = (width / 2 - 5) + 'px';
          rod.appendChild(support);
        }

        row.appendChild(rod);

        if (index < segments.length - 1) {
          const connector = document.createElement('div');
          connector.className = 'bracket connector';
          row.appendChild(connector);
        }
      });

      const right = document.createElement('div');
      right.className = 'bracket right';
      row.appendChild(right);

      container.appendChild(row);
    }*/
	  document.addEventListener('DOMContentLoaded', () => {
  const spoolWidthInput = document.getElementById('spoolWidth');
  const spoolWidthLabel = document.getElementById('spoolWidthLabel');

  function updateSpoolWidthLabel() {
    const width = parseInt(spoolWidthInput.value, 10);
    if (!isNaN(width)) {
      spoolWidthLabel.textContent = width;
    }
  }

  // aktualizuj po zmianie inputa
  spoolWidthInput.addEventListener('input', updateSpoolWidthLabel);

  // zainicjuj przy starcie
  updateSpoolWidthLabel();
});
  </script>
</body>
</html>
