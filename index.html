<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Kalkulator Półek na filamenty z systemu IKEA Komplement</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #f9f9f9;
    }

    .container {
      max-width: 900px;
      margin: 20px auto;
      padding: 0 15px;
      box-sizing: border-box;
    }

    h1 {
      text-align: center;
      font-size: 1.8em;
    }

    .calculator {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
      background: #efefef;
      padding: 20px;
      border-radius: 10px;
      position: relative;
    }

    .input-section, .output-section {
      flex: 1 1 300px;
    }

    .input-section label {
      display: block;
      margin: 10px 0 5px;
    }

    .segment-input {
      width: 100%;
      padding: 5px;
      font-size: 1em;
      box-sizing: border-box;
    }

    .button-wrapper {
      margin-top: 15px;
      position: relative;
    }

    .calculate-button {
      padding: 12px 24px;
      font-size: 1.1em;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }

    .language-toggle {
      position: absolute;
      right: 0;
      top: 0;
      font-size: 0.9em;
      background: none;
      border: none;
      cursor: pointer;
      text-decoration: underline;
      color: #333;
    }

    .results-container {
      display: flex;
      flex-direction: column;
      gap: 20px;
      margin-top: 30px;
    }

    .section-box {
      background: #efefef;
      padding: 15px;
      border-radius: 10px;
    }

    .section-title {
      font-weight: bold;
      margin-bottom: 10px;
    }

    .visualization {
      display: flex;
      flex-direction: row;
      align-items: center;
      gap: 0;
      overflow-x: auto;
      padding-bottom: 10px;
    }

    .shelf-row {
      display: flex;
      align-items: center;
      position: relative;
      gap: 0;
      user-select: none;
    }

    .bracket {
      width: 20px;
      height: 40px;
      display: inline-block;
      box-sizing: border-box;
    }

    .bracket.left, .bracket.right {
      background-color: green;
      border-radius: 0;
    }

    .bracket.connector {
      background-color: red;
      width: 10px;
      height: 40px;
      margin-left: 0;
      margin-right: 0;
      border-radius: 0;
    }

    .bracket.support {
      background-color: goldenrod;
      width: 10px;
      height: 40px;
      position: absolute;
      top: 0;
      border-radius: 0;
    }

    .rod {
      height: 40px;
      background-color: #bbb;
      display: inline-block;
      position: relative;
      border-radius: 0;
      margin: 0;
      flex-shrink: 0;
      box-sizing: border-box;
    }

    .rod.white {
      background-color: #e8e8e8;
      border: 1px solid #ccc;
    }

    .rod.gray {
      background-color: #666;
    }

    .output-columns {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }

    .output-column {
      flex: 1 1 300px;
      background: #efefef;
      padding: 15px;
      border-radius: 10px;
    }

    .bracket-info span {
      display: block;
      margin-bottom: 5px;
    }

    .green { color: green; }
    .red { color: red; }
    .yellow { color: goldenrod; }
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title">Kalkulator Półek na filamenty z systemu IKEA Komplement</h1>
    <div class="calculator">
      <div class="input-section">
        <label for="rodColor" id="labelColor">Kolor drążków:</label>
        <select id="rodColor" class="segment-input">
          <option value="white">Biały</option>
          <option value="gray">Szary</option>
        </select>
        <label id="labelPick">Wybierz swoje segmenty:</label>
        <label for="seg50" id="label50">Segmenty z IKEA Komplement 50 cm:</label>
        <input id="seg50" type="number" min="0" value="0" class="segment-input" />
        <label for="seg75" id="label75">Segmenty z IKEA Komplement 75 cm:</label>
        <input id="seg75" type="number" min="0" value="0" class="segment-input" />
        <label for="seg100" id="label100">Segmenty z IKEA Komplement 100 cm:</label>
        <input id="seg100" type="number" min="0" value="0" class="segment-input" />
      </div>
      <div class="output-section">
        <div class="button-wrapper">
          <button class="calculate-button" onclick="calculate()" id="calculateBtn">Oblicz</button>
          <button class="language-toggle" onclick="toggleLanguage()" id="langBtn">EN</button>
        </div>
      </div>
    </div>

    <div class="results-container">
      <div class="section-box">
        <div class="section-title" id="lengthTitle">Długość całkowita</div>
        <div id="shelfLength"></div>
      </div>
      <div class="section-box">
        <div class="section-title" id="visualTitle">Wizualizacja</div>
        <div id="visualization" class="visualization"></div>
      </div>
      <div class="output-columns">
        <div class="output-column">
          <div class="section-title" id="bracketsTitle">Wsporniki do wydrukowania</div>
          <div id="bracketCounts" class="bracket-info"></div>
        </div>
        <div class="output-column">
          <div class="section-title" id="ikeaTitle">Zakupy w IKEA</div>
          <div id="ikeaList"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    let currentLang = 'pl';

    const translations = {
      pl: {
        title: 'Kalkulator Półek na filamenty z systemu IKEA Komplement',
        labelColor: 'Kolor drążków:',
        labelPick: 'Wybierz swoje segmenty:',
        label50: 'Segmenty z IKEA Komplement 50 cm:',
        label75: 'Segmenty z IKEA Komplement 75 cm:',
        label100: 'Segmenty z IKEA Komplement 100 cm:',
        calculate: 'Oblicz',
        lengthTitle: 'Długość całkowita',
        visualTitle: 'Wizualizacja',
        bracketsTitle: 'Wsporniki do wydrukowania',
        ikeaTitle: 'Zakupy w IKEA',
        left: 'Wspornik lewy',
        right: 'Wspornik prawy',
        connector: 'Wspornik łączący',
        support: 'Wspornik podtrzymujący'
      },
      en: {
        title: 'IKEA Komplement Filament Rack System Configurator',
        labelColor: 'Choose Your clothes rails color:',
        labelPick: 'Pick your singular shelf segments:',
        label50: 'Segments built with IKEA Komplement 50 cm:',
        label75: 'Segments built with IKEA Komplement 75 cm:',
        label100: 'Segments built with IKEA Komplement 100 cm:',
        calculate: 'Calculate',
        lengthTitle: 'Total length',
        visualTitle: 'Visualization',
        bracketsTitle: 'Holders to 3Dprint',
        ikeaTitle: 'IKEA shopping list',
        left: 'Holder Left',
        right: 'Holder Right',
        connector: 'Holder Connector',
        support: 'Holder Middle'
      }
    };

    function toggleLanguage() {
      currentLang = currentLang === 'pl' ? 'en' : 'pl';
      const t = translations[currentLang];
      document.getElementById('langBtn').innerText = currentLang === 'pl' ? 'EN' : 'PL';
      document.getElementById('title').innerText = t.title;
      document.getElementById('labelColor').innerText = t.labelColor;
      document.getElementById('labelPick').innerText = t.labelPick;
      document.getElementById('label50').innerText = t.label50;
      document.getElementById('label75').innerText = t.label75;
      document.getElementById('label100').innerText = t.label100;
      document.querySelector('.calculate-button').innerText = t.calculate;
      document.getElementById('lengthTitle').innerText = t.lengthTitle;
      document.getElementById('visualTitle').innerText = t.visualTitle;
      document.getElementById('bracketsTitle').innerText = t.bracketsTitle;
      document.getElementById('ikeaTitle').innerText = t.ikeaTitle;
      calculate(); // Refresh results on language change
    }

    // Dane IKEA
    const ikeaProducts = {
      left: { code: '002.225.37', name: 'Wspornik lewy' },
      right: { code: '002.225.38', name: 'Wspornik prawy' },
      connector: { code: '002.225.39', name: 'Wspornik łączący' },
      support: { code: '403.234.32', name: 'Wspornik podtrzymujący' }
    };

    function createGoogleSearchLink(code) {
      const url = `https://www.google.com/search?q=${code}`;
      return `<a href="${url}" target="_blank" rel="noopener noreferrer">${code}</a>`;
    }

    function calculate() {
      // Pobierz wartości segmentów
      const seg50 = parseInt(document.getElementById('seg50').value) || 0;
      const seg75 = parseInt(document.getElementById('seg75').value) || 0;
      const seg100 = parseInt(document.getElementById('seg100').value) || 0;
      const rodColor = document.getElementById('rodColor').value;

      const segmentLengths = [50, 75, 100];

      // Całkowita liczba segmentów i ich długość w cm
      const totalSegments = seg50 + seg75 + seg100;

      // Kalkulacja długości półek:
      // Długość to suma segmentów + (szerokość wsporników * (ilość segmentów +1))
      // Szerokość wspornika: 1.5 cm (15 mm)
      const bracketWidth = 1.5; // cm

      // Suma długości segmentów:
      const segmentsLengthCm = seg50 * 50 + seg75 * 75 + seg100 * 100;

      // Całkowita długość półki:
      // Liczba wsporników poziomych: totalSegments + 1 (bo po obu końcach plus między segmentami)
      // Liczba wsporników pionowych (łączących) to totalSegments - 1 (między segmentami)
      // Liczba wsporników podtrzymujących to totalSegments (jeden pod każdy segment)
      const totalLengthCm = segmentsLengthCm + bracketWidth * (totalSegments + 1);

      // Wyświetl długość w cm i mm (np. 177.5 cm)
      document.getElementById('shelfLength').innerText = totalLengthCm.toFixed(1) + ' cm';

      // Wizualizacja
      // Czyścimy poprzednią wizualizację
      const viz = document.getElementById('visualization');
      viz.innerHTML = '';

      if (totalSegments === 0) {
        viz.innerHTML = currentLang === 'pl' ? 'Wprowadź ilość segmentów.' : 'Please enter segments quantity.';
        // Czyścimy inne wyniki
        document.getElementById('bracketCounts').innerHTML = '';
        document.getElementById('ikeaList').innerHTML = '';
        return;
      }

      // Wizualizacja - budujemy ciąg elementów: wspornik lewy, segment + wspornik łączący itd, wspornik prawy
      // Każdy segment jest "rod" o szerokości = segment_length + bracketWidth (z lewej lub prawej)
      // Dla uproszczenia: każdy segment to szara belka (szary lub biały wg wyboru)

      function createBracket(type) {
        const div = document.createElement('div');
        div.classList.add('bracket');
        div.classList.add(type);
        div.title = translations[currentLang][type];
        if (type === 'left' || type === 'right') {
          div.style.width = bracketWidth * 10 + 'px'; // 15mm = 1.5cm * 10px/cm = 15px
          div.style.height = '40px';
          div.style.backgroundColor = 'green';
        } else if (type === 'connector') {
          div.style.width = bracketWidth * 6 + 'px'; // trochę węższy
          div.style.height = '40px';
          div.style.backgroundColor = 'red';
        } else if (type === 'support') {
          div.style.width = bracketWidth * 6 + 'px';
          div.style.height = '40px';
          div.style.backgroundColor = 'goldenrod';
          div.style.position = 'relative';
          div.style.top = '10px';
        }
        return div;
      }

      // Budujemy element segmentu
      function createRod(lengthCm, color) {
        const div = document.createElement('div');
        div.classList.add('rod');
        div.classList.add(color);
        div.style.width = (lengthCm * 10) + 'px'; // 10px na 1 cm
        div.style.height = '40px';
        div.style.borderRadius = '0';
        div.style.margin = '0';
        div.style.flexShrink = '0';
        return div;
      }

      // Tworzymy rząd półki z segmentów i wsporników
      // Struktura: [left bracket] [segment][connector] [segment][connector] ... [segment] [right bracket]

      // Łączymy segmenty w jeden rząd
      let segmentsArray = [];
      // Dodajemy segmenty 50cm
      for (let i = 0; i < seg50; i++) {
        segmentsArray.push(50);
      }
      // Dodajemy segmenty 75cm
      for (let i = 0; i < seg75; i++) {
        segmentsArray.push(75);
      }
      // Dodajemy segmenty 100cm
      for (let i = 0; i < seg100; i++) {
        segmentsArray.push(100);
      }

      // Cały rząd
      viz.appendChild(createBracket('left'));

      segmentsArray.forEach((segLength, idx) => {
        viz.appendChild(createRod(segLength, rodColor));
        if (idx < segmentsArray.length - 1) {
          viz.appendChild(createBracket('connector'));
        }
      });

      viz.appendChild(createBracket('right'));

      // Wsporniki podtrzymujące (support) - jeden pod każdym segmentem - pokazujemy pod wizualizacją jako rząd punktów
      const supportRow = document.createElement('div');
      supportRow.style.display = 'flex';
      supportRow.style.justifyContent = 'flex-start';
      supportRow.style.marginTop = '5px';
      supportRow.style.gap = '0';

      segmentsArray.forEach(() => {
        const support = createBracket('support');
        supportRow.appendChild(support);
      });
      viz.appendChild(supportRow);

      // Liczymy wsporniki:
      // 2 na koniec (left, right)
      // 1 na łączenie segmentów (connector) = totalSegments-1, jeśli >0
      // 1 podtrzymujący na każdy segment

      const leftCount = 1;
      const rightCount = 1;
      const connectorCount = totalSegments > 1 ? totalSegments - 1 : 0;
      const supportCount = totalSegments;

      // Wyświetlamy wyniki
      const bracketCountsDiv = document.getElementById('bracketCounts');
      bracketCountsDiv.innerHTML = `
        <span class="green">${translations[currentLang].left}: ${leftCount}</span>
        <span class="green">${translations[currentLang].right}: ${rightCount}</span>
        <span class="red">${translations[currentLang].connector}: ${connectorCount}</span>
        <span class="yellow">${translations[currentLang].support}: ${supportCount}</span>
      `;

      // Lista zakupów IKEA:
      // Zakładamy, że na 1 segment potrzebujemy kompletu 2 wsporników (left + right) na końce segmentu
      // oraz 1 wspornik podtrzymujący, i na połączenia między segmentami 1 wspornik łączący na każde złączenie
      // Liczymy łącznie:
      // Wspornik lewy i prawy: 2 * totalSegments
      // Wspornik podtrzymujący: totalSegments
      // Wspornik łączący: totalSegments-1 (jeśli >0)

      const ikeaListDiv = document.getElementById('ikeaList');

      // Funkcja pomocnicza generująca element listy z linkiem do Google:
      function itemRow(product, qty) {
        if (qty <= 0) return '';
        return `<div>${qty} × ${product.name} - ${createGoogleSearchLink(product.code)}</div>`;
      }

      const leftQty = totalSegments * 1; // po 1 na każdy segment (z lewej strony)
      const rightQty = totalSegments * 1; // po 1 na każdy segment (z prawej)
      const supportQty = totalSegments;
      const connectorQty = connectorCount;

      ikeaListDiv.innerHTML =
        itemRow(ikeaProducts.left, leftQty) +
        itemRow(ikeaProducts.right, rightQty) +
        itemRow(ikeaProducts.support, supportQty) +
        itemRow(ikeaProducts.connector, connectorQty);
    }

    // Inicjalizacja - wyświetl po ładowaniu
    window.onload = () => {
      calculate();
    };
  </script>
</body>
</html>
