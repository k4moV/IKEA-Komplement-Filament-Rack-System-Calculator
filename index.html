<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Kalkulator Półek na filamenty z systemu IKEA Komplement</title>
  <style>
    /* ... style pozostają bez zmian ... */
  </style>
</head>
<body>
  <div class="container">
    <h1 id="title">Kalkulator Półek na filamenty z systemu IKEA Komplement</h1>

    <!-- Dodany selector języka -->
    <div style="text-align:center; margin-bottom:15px;">
      <label for="languageSelect" id="langLabel">Wybierz język:</label>
      <select id="languageSelect" onchange="setLanguage(this.value)">
        <option value="pl" selected>Polski</option>
        <option value="en">English</option>
      </select>
    </div>

    <div class="calculator">
      <div class="input-section">
        <label for="rodColor" id="rodColorLabel">Kolor drążków:</label>
        <select id="rodColor" class="segment-input">
          <option value="white" id="whiteOption">Biały</option>
          <option value="gray" id="grayOption">Szary</option>
        </select>
        <label id="segmentsLabel">Wybierz swoje segmenty:</label>
        <label for="seg50" id="seg50Label">Segmenty z IKEA Komplement 50 cm:</label>
        <input id="seg50" type="number" min="0" value="0" class="segment-input" />
        <label for="seg75" id="seg75Label">Segmenty z IKEA Komplement 75 cm:</label>
        <input id="seg75" type="number" min="0" value="0" class="segment-input" />
        <label for="seg100" id="seg100Label">Segmenty z IKEA Komplement 100 cm:</label>
        <input id="seg100" type="number" min="0" value="0" class="segment-input" />
      </div>
      <div class="output-section">
        <div class="button-wrapper">
          <button class="calculate-button" onclick="calculate()" id="calculateBtn">Oblicz</button>
        </div>
      </div>
    </div>

    <div class="results-container">
      <div class="section-box">
        <div class="section-title" id="totalLengthTitle">Długość całkowita</div>
        <div id="shelfLength"></div>
      </div>
      <div class="section-box">
        <div class="section-title" id="visualizationTitle">Wizualizacja</div>
        <div id="visualization" class="visualization"></div>
      </div>
      <div class="output-columns">
        <div class="output-column">
          <div class="section-title" id="bracketsTitle">Wsporniki do wydrukowania</div>
          <div id="bracketCounts" class="bracket-info"></div>
        </div>
        <div class="output-column">
          <div class="section-title" id="ikeaShoppingTitle">Zakupy w IKEA</div>
          <div id="ikeaList"></div>
        </div>
      </div>
    </div>
  </div>

<script>
  const ROD_LENGTHS = {
    '50': 450,
    '75': 700,
    '100': 950
  };

  const IKEA_CODES = {
    white: {
      '50': '902.568.93',
      '75': '402.568.95',
      '100': '302.568.91'
    },
    gray: {
      '50': '402.569.42',
      '75': '002.569.44',
      '100': '802.569.40'
    }
  };

  // Teksty w obu językach
  const texts = {
    pl: {
      title: "Kalkulator Półek na filamenty z systemu IKEA Komplement",
      langLabel: "Wybierz język:",
      rodColorLabel: "Kolor drążków:",
      whiteOption: "Biały",
      grayOption: "Szary",
      segmentsLabel: "Wybierz swoje segmenty:",
      seg50Label: "Segmenty z IKEA Komplement 50 cm:",
      seg75Label: "Segmenty z IKEA Komplement 75 cm:",
      seg100Label: "Segmenty z IKEA Komplement 100 cm:",
      calculateBtn: "Oblicz",
      totalLengthTitle: "Długość całkowita",
      visualizationTitle: "Wizualizacja",
      bracketsTitle: "Wsporniki do wydrukowania",
      ikeaShoppingTitle: "Zakupy w IKEA",
      brackets: {
        left: "Wspornik lewy",
        right: "Wspornik prawy",
        connector: "Wspornik łączący",
        support: "Wspornik podtrzymujący"
      },
      ikeaItemLabel: "Komplement"
    },
    en: {
      title: "IKEA Komplement Filament Shelf Calculator",
      langLabel: "Choose language:",
      rodColorLabel: "Rod color:",
      whiteOption: "White",
      grayOption: "Gray",
      segmentsLabel: "Choose your segments:",
      seg50Label: "IKEA Komplement segments 50 cm:",
      seg75Label: "IKEA Komplement segments 75 cm:",
      seg100Label: "IKEA Komplement segments 100 cm:",
      calculateBtn: "Calculate",
      totalLengthTitle: "Total length",
      visualizationTitle: "Visualization",
      bracketsTitle: "Brackets to print",
      ikeaShoppingTitle: "Shopping at IKEA",
      brackets: {
        left: "Left bracket",
        right: "Right bracket",
        connector: "Connector bracket",
        support: "Support bracket"
      },
      ikeaItemLabel: "Komplement"
    }
  };

  let currentLang = 'pl';

  function setLanguage(lang) {
    currentLang = lang;

    // Podmiana tekstów w interfejsie
    document.getElementById('title').innerText = texts[lang].title;
    document.getElementById('langLabel').innerText = texts[lang].langLabel;
    document.getElementById('rodColorLabel').innerText = texts[lang].rodColorLabel;
    document.getElementById('whiteOption').innerText = texts[lang].whiteOption;
    document.getElementById('grayOption').innerText = texts[lang].grayOption;
    document.getElementById('segmentsLabel').innerText = texts[lang].segmentsLabel;
    document.getElementById('seg50Label').innerText = texts[lang].seg50Label;
    document.getElementById('seg75Label').innerText = texts[lang].seg75Label;
    document.getElementById('seg100Label').innerText = texts[lang].seg100Label;
    document.getElementById('calculateBtn').innerText = texts[lang].calculateBtn;
    document.getElementById('totalLengthTitle').innerText = texts[lang].totalLengthTitle;
    document.getElementById('visualizationTitle').innerText = texts[lang].visualizationTitle;
    document.getElementById('bracketsTitle').innerText = texts[lang].bracketsTitle;
    document.getElementById('ikeaShoppingTitle').innerText = texts[lang].ikeaShoppingTitle;

    // Po zmianie języka przelicz ponownie, jeśli są wartości
    if (document.getElementById('seg50').value !== "0" ||
        document.getElementById('seg75').value !== "0" ||
        document.getElementById('seg100').value !== "0") {
      calculate();
    } else {
      // Wyczyszczenie wyników jeśli brak segmentów
      document.getElementById('shelfLength').innerText = '';
      document.getElementById('bracketCounts').innerHTML = '';
      document.getElementById('ikeaList').innerHTML = '';
      document.getElementById('visualization').innerHTML = '';
    }
  }

  function calculate() {
    const rodColor = document.getElementById('rodColor').value;
    const seg50 = parseInt(document.getElementById('seg50').value) || 0;
    const seg75 = parseInt(document.getElementById('seg75').value) || 0;
    const seg100 = parseInt(document.getElementById('seg100').value) || 0;

    const segments = [];
    for (let i = 0; i < seg50; i++) segments.push(50);
    for (let i = 0; i < seg75; i++) segments.push(75);
    for (let i = 0; i < seg100; i++) segments.push(100);

    if(segments.length === 0) {
      document.getElementById('shelfLength').innerText = '';
      document.getElementById('bracketCounts').innerHTML = '';
      document.getElementById('ikeaList').innerHTML = '';
      document.getElementById('visualization').innerHTML = '';
      return;
    }

    const totalLength = segments.reduce((acc, val) => acc + ROD_LENGTHS[val], 0)
      + 20 + 20 + (segments.length - 1) * 10;

    const bracketCounts = {
      left: segments.length > 0 ? 1 : 0,
      right: segments.length > 0 ? 1 : 0,
      connector: Math.max(0, segments.length - 1),
      support: segments.filter(len => len === 75 || len === 100).length
    };

    const ikeaItems = {
      '50': seg50 * 2,
      '75': seg75 * 2,
      '100': seg100 * 2
    };

    document.getElementById('shelfLength').innerText = `${totalLength} mm`;

    let bracketHTML = '';
    if (bracketCounts.left > 0) bracketHTML += `<span class="green">${texts[currentLang].brackets.left}: ${bracketCounts.left}</span>`;
    if (bracketCounts.right > 0) bracketHTML += `<span class="green">${texts[currentLang].brackets.right}: ${bracketCounts.right}</span>`;
    if (bracketCounts.connector > 0) bracketHTML += `<span class="red">${texts[currentLang].brackets.connector}: ${bracketCounts.connector}</span>`;
    if (bracketCounts.support > 0) bracketHTML += `<span class="yellow">${texts[currentLang].brackets.support}: ${bracketCounts.support}</span>`;
    document.getElementById('bracketCounts').innerHTML = bracketHTML;

    let ikeaHTML = '';
    Object.keys(ikeaItems).forEach(k => {
      if (ikeaItems[k] > 0) {
        const code = IKEA_CODES[rodColor][k];
        const searchUrl = `https://www.google.com/search?q=${code}`;
        ikeaHTML += `<div>${ikeaItems[k]}x ${texts[currentLang].ikeaItemLabel} ${k} cm - <a href="${searchUrl}" target="_blank">${code}</a></div>`;
      }
    });
    document.getElementById('ikeaList').innerHTML = ikeaHTML;

    renderVisualization(segments, rodColor);
  }

  function renderVisualization(segments, color) {
    const container = document.getElementById('visualization');
    container.innerHTML = '';
    if(segments.length === 0) return;

    const row = document.createElement('div');
    row.className = 'shelf-row';
    row.style.position = 'relative';

    const left = document.createElement('div');
    left.className = 'bracket left';
    row.appendChild(left);

    segments.forEach((seg, index) => {
      const rod = document.createElement('div');
      rod.className = 'rod';
      rod.style.backgroundColor = color === 'gray' ? '#666' : '#ccc';
      const width = ROD_LENGTHS[seg] / 5;
      rod.style.width = width + 'px';

      if (seg === 75 || seg === 100) {
        const support = document.createElement('div');
        support.className = 'bracket support';
        support.style.left = (width / 2 - 5) + 'px';
        rod.appendChild(support);
      }

      row.appendChild(rod);

      if (index < segments.length - 1) {
        const connector = document.createElement('div');
        connector.className = 'bracket connector';
        row.appendChild(connector);
      }
    });

    const right = document.createElement('div');
    right.className = 'bracket right';
    row.appendChild(right);

    container.appendChild(row);
  }

  // Ustaw domyślny język na starcie strony
  setLanguage(currentLang);
</script>
</body>
</html>
